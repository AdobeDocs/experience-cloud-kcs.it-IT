---
title: "Quali richieste AEM la cache del Dispatcher?"
description: Descrizione
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS, dispatcher AEM, cache, AEM, richiesta HTTP"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Nayanika Chakravarty
article-created-date: "3/23/2023 8:59:59 PM"
article-published-by: Nayanika Chakravarty
article-published-date: "3/23/2023 9:07:34 PM"
version-number: 3
article-number: KA-17497
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=f11495a9-bdc9-ed11-b597-6045bd006b4b"
source-git-commit: fed544ddac29ee57604bf63dad5d301498def8b5
workflow-type: tm+mt
source-wordcount: '442'
ht-degree: 8%

---

# Quali richieste AEM la cache del Dispatcher?

## Descrizione {#description}


<b>Ambiente</b>

AEM Dispatcher 4.3.3

<b>Problema</b>

Questo articolo determina il motivo per cui la richiesta/risposta HTTP non viene memorizzata nella cache da AEM Dispatcher.
<br><br> <br>

## Risoluzione {#resolution}


La documentazione descrive gli scenari più importanti che influiscono sulla cache-ability delle richieste e delle risposte che passano attraverso il modulo AEM Dispatcher. Tutte le regole della cache non sono coperte.

<b>Regole di richiesta e memorizzazione in cache HTTP</b>

Affinché una richiesta HTTP possa essere memorizzata in cache dal dispatcher, deve rispettare le seguenti regole:

1. L’URL è assoluto (non funziona con . o ..), ha un&#39;estensione di file e il nome del file nell&#39;URL funziona come file sul file system.

   Messaggi di registro correlati:


   ```
   URI not canonical: %s.
   
   Unable to map URI to file: %s.
   
   cache file path too long
   
   temporary file path too long
   
   request URL has no extension
   ```



   Esempi:


   | `/content/test` | non memorizzato nella cache |
   | --- | --- |
   | `/content/test.html` | memorizzato in cache |


2. Non ha barre dopo la prima estensione di file.

   Messaggi di registro correlati:


   ```
   request URL has trailing slash
   ```



   Esempi:


   | `/content/test.html/` | non memorizzato nella cache |
   | --- | --- |
   | `/content/test.html/foo.jpg` | non memorizzato nella cache |
   | `/content/test.html` | memorizzato in cache |


3. Utilizza il metodo HTTP GET o HEAD.

   Messaggi di registro correlati:


   ```
   request method is neither GET nor HEAD
   ```



   Esempi:


   | `HEAD /content/test.html HTTP/1.1` | memorizzato in cache |
   | --- | --- |
   | `GET /content/dam/test.jpg HTTP/1.1` | non memorizzato nella cache |
   | `POST /content/test.html HTTP/1.1` | non memorizzato nella cache |


4. La richiesta è negata da /CACHE = /Rules definita nel dispatcher. QUALSIASI CONFIGURAZIONE DI FARM.

   Messaggi di registro correlati:


   ```
   URI not  in cache rules: %s request URL not in cache rules
   ```



   Esempi:


   | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html<br>    <br>    /cache<br>    <br>    {<br>    <br>     ...<br>    <br>     /rules<br>    <br>     {<br>    <br>      /0001 {<br>    <br>      type "deny"<br>    <br>      glob "*"<br>    <br>      }<br>    <br>     }<br>    <br>    }<br>    ```<br><br> | non memorizzato nella cache |
   | --- | --- |
   | <br><br>    ```<br>    Farm has /cache = /rules and a request is received for /content/test.html<br>    <br>    /cache<br>    <br>    {<br>    <br>     ...<br>    <br>     /rules<br>    <br>     {<br>    <br>      /0001 {<br>    <br>      type "allow"<br>    <br>      glob "*"<br>    <br>      }<br>    <br>     }<br>    <br>    }<br>    ```<br><br> | memorizzato in cache |


5. La richiesta HTTP non contiene un&#39;intestazione di autorizzazione o contiene l&#39;intestazione ma /ALLOWAUTHORIZED è impostato su 1 nella CONFIGURAZIONE FARM.

   Messaggi di registro correlati:


   ```
   request contains authorization
   ```



   Esempi:


   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1<br>    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l<br>    <br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /cache {<br>      <br>     /allowAuthorized “0”<br>    }<br>    ```<br><br> | non memorizzato nella cache |
   | --- | --- |
   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1<br>    Authorization: Basic YWxhZGRpbjpvcGVuc2VzYW1l<br>    <br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /cache {<br>      <br>     /allowAuthorized “1”<br>    }<br>    ```<br><br> | memorizzato in cache |


6. La richiesta HTTP contiene LOGIN-TOKEN o AUTHORIZATION COOKIE nell&#39;intestazione del cookie o contiene (o entrambi) di questi cookie e /ALLOWAUTHORIZED è impostato su 1 nella CONFIGURAZIONE FARM.

   Messaggi di registro correlati:


   ```
   request contains authorization
   ```



   Esempi:


   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1<br>    Cookie: login-token=…<br>    <br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /cache {<br>      <br>     /allowAuthorized “0”<br>    }<br>    ```<br><br> | non memorizzato nella cache |
   | --- | --- |
   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1<br>    Cookie: authorization=YWxhZGRpbjpvcGVuc2VzYW1l<br>    <br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /cache {<br>      <br>     /allowAuthorized “0”<br>    }<br>    ```<br><br> | non memorizzato nella cache |
   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html HTTP/1.1<br>    Cookie: login-token=…<br>    <br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /cache {<br>      <br>     /allowAuthorized “1”<br>    }<br>    ```<br><br> | memorizzato in cache |


7. Nell’URL è presente un parametro QUERYSTRING e il parametro può essere ignorato tramite la CONFIGURAZIONE /IGNOREURLPARAMS DI FARM.

   Messaggi di registro correlati:


   ```
   request contains a query string
   ```



   Esempi:


   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1<br>    Farm /cache configuration:<br>    <br>    /ignoreUrlParams {<br>     /0001 { /type “allow” /glob “*” }<br>    }<br>    ```<br><br> | memorizzato in cache |
   | --- | --- |
   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1<br>    Farm /cache configuration:<br>    <br>    /ignoreUrlParams {<br>     /0001 { /type “deny” /glob “*” } <br>      <br>     /0001 { /type “allow” /glob “test” }<br>    }<br>    ```<br><br> | memorizzato in cache |
   | Richiesta HTTP:<br><br>    ```<br>    GET /content/test.html?test=1 HTTP/1.1<br>    dispatcher.any farm /cache = /allowAuthorized configuration:<br>    <br>    /ignoreUrlParams {<br>    <br>     /0001 { /type “deny” /glob “*” } <br>      <br>     /0001 { /type “allow” /glob “q” }<br>    }<br>    ```<br><br> | non memorizzato nella cache |




<b>Regole di risposta HTTP e memorizzazione in cache:</b>



La risposta HTTP restituita da AEM è memorizzabile in cache se sono soddisfatti i seguenti criteri:

1. Il dispatcher è in grado di inviare e ricevere una risposta di 200 OK da uno dei &quot;RENDERS&quot; definiti.

   <b>Nota:</b> Se no [/timeout](https://experienceleague.adobe.com/docs/experience-manager-dispatcher/using/configuring/dispatcher-configuration.html?lang=it) è impostato su /renders o su 0, quindi aspetterebbe per sempre una connessione all&#39;istanza AEM anche se l&#39;istanza è inattiva.
Messaggi di registro correlati:


   ```
   Unable to send request to remote server. Unable to receive response from remote server. Remote server returned: %s No backend available.
   ```



   Esempi:


   | Richiesta HTTP:<br><br>    200 OK | memorizzato in cache |
   | --- | --- |
   | Richiesta HTTP:<br><br>    404 Pagina non trovata | non memorizzato nella cache |


2. Nessuna di queste intestazioni di risposta è presente nella risposta:

   - `Dispatcher: no-cache`
   - `Cache-control: no-cache`
   - `Pragma: no-cache`

   Messaggi di registro correlati:


   ```
   Backend forbids caching: %s, sent: %s" response contains no_cache
   ```



   Esempi:


   | Risposta HTTP:<br><br>    200 OK<br><br>    Dispatcher: no-cache | non memorizzato nella cache |
   | --- | --- |
   | Risposta HTTP:<br><br>    200 OK<br><br>    Controllo cache: no-cache | non memorizzato nella cache |
   | Risposta HTTP:<br><br>    200 OK<br><br>    Pragma: no-cache | non memorizzato nella cache |
   | Risposta HTTP:<br><br>    200 OK | memorizzato in cache |


3. Il valore della lunghezza del contenuto è maggiore di ZERO BYTES.
Messaggi di registro correlati:


   ```
   response content length is zero
   ```



   Esempi:


   | Risposta HTTP:<br><br>    200 OK<br><br>    Lunghezza del contenuto: 0 | non memorizzato nella cache |
   | --- | --- |
   | Risposta HTTP:<br><br>    200 OK<br><br>    Lunghezza del contenuto: 3120 | memorizzato in cache |



