---
title: "L'utilizzo del disco è insolitamente elevato o in rapido aumento su AEM server"
description: Descrizione
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager 6.4,Experience Manager 6.5"
keywords: "KCS, AEM, prestazioni, disco pieno"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Nayanika Chakravarty
article-created-date: "5/2/2023 8:37:19 PM"
article-published-by: Nayanika Chakravarty
article-published-date: "5/2/2023 9:42:51 PM"
version-number: 4
article-number: KA-17496
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=104d8e1f-29e9-ed11-a7c6-6045bd006268"
source-git-commit: fcb7ca716bedb896740d73062a29c5552bd5eb2b
workflow-type: tm+mt
source-wordcount: '0'
ht-degree: 0%

---

# L&#39;utilizzo del disco è insolitamente elevato o in rapido aumento su AEM server

## Descrizione {#description}


<b>Ambiente</b>

Adobe Experience Manager

<b>Problema/Sintomi</b>

L&#39;utilizzo del disco è insolitamente elevato o in rapido aumento su un server AEM. Con lo spazio su disco esaurito, AEM ha smesso di funzionare.




## Risoluzione {#resolution}

<b>A. Se AEM è in esecuzione e c&#39;è ampio spazio su disco</b>
1. <b>Configurare la registrazione di traccia di scrittura di oak</b>    Se AEM è ancora in esecuzione, possiamo abilitare un logger di debug per dirci su quali percorsi dell&#39;archivio vengono scritti. Per abilitare questo logger, installa il pacchetto di configurazione del registro allegato qui sotto o segui questi passaggi:

   1. Vai a *https://aemhost:port/system/console/slinglog*
   2. Fai clic su <b>Aggiungi nuovo logger</b>.
   3. Configura un logger: <b>File di log:</b> logs/repgrowth.log <b>Livello di log</b>: traccia, <b>Loggers:</b> org.apache.jackrabbit.oak.jcr.operations.writes
   4. Scarica [file](https://helpx.adobe.com/content/dam/help/en/experience-manager/kb/analyze-unusual-repository-growth/jcr:content/main-pars/download/log_repository_growth-1.zip).        Questo pacchetto contiene la configurazione richiesta per la sessione di scrittura della registrazione per Oak. Installa questo pacchetto tramite il CRX Package Manager. Dopo il periodo di monitoraggio, assicurati di disinstallare il pacchetto.

   <b>Attenzione</b>

   - Il registro include informazioni su tutte le scritture e i dettagli della sessione. Se utilizzi questo logger, assicurati di disporre di spazio su disco sufficiente.
   - Disinstalla il pacchetto di configurazione del registro o rimuovi la configurazione del registro dopo un breve periodo di abilitazione per evitare ulteriori consumi di spazio su disco.
2. <b>Eseguire il rapporto sull&#39;utilizzo del disco</b>    È inoltre possibile sfruttare il rapporto Utilizzo disco https://host:port/etc/reports/diskusage.html. Questo rapporto visualizza lo spazio su disco utilizzato dal percorso dell&#39;archivio. Il rapporto è perforabile e consente di visualizzare anche i sottoalberi.
3. <b>Cattura le immagini thread ed esegui il profiling</b>    Dopo aver utilizzato il file repgrowth.log per avere un&#39;idea di quali dati vengono scritti, possiamo ottenere informazioni su quale codice sta scrivendo quei dati catturando le immagini di thread ed eseguendo il profiling della CPU. Visita queste pagine:

   - [Profiling CPU](https://experienceleague.adobe.com/docs/experience-cloud-kcs/kbarticles/KA-17499.html?lang=it)
   - [Catturare le immagini di thread](https://experienceleague.adobe.com/docs/experience-cloud-kcs/kbarticles/KA-17452.html?lang=it)
   - [Analisi delle immagini di thread AEM](https://experienceleague.adobe.com/docs/experience-cloud-kcs/kbarticles/KA-16458.html?lang=it)

<b>B. Se AEM si è arrestato e/o lo spazio su disco è quasi pieno</b>
Se si è dovuto interrompere la AEM per evitare la crescita dello spazio su disco, utilizzare i comandi riportati di seguito per eseguire alcune analisi iniziali.

- Su piattaforma Linux, sfrutta la <b>du</b> comando per elencare tutte le directory sotto <b>crx-quickstart</b> con la dimensione riassunta di tali directory:<br>

   ```
   du -h --max-depth=2 crx-quickstart
   ```
- Utilizzo <b>trova</b> e <b>du</b> comandi per trovare i file modificati di recente e ottenere le loro dimensioni:

   ```
   find crx-quickstart -type f -mtime 1 -exec du -hs {} \; -print
   ```
- Per trovare file di grandi dimensioni nel datastore, è possibile combinare <b>trova</b>, <b>du</b>e <b>file</b> comandi per trovare file superiori a 100 MB nel <b>datastore</b> e identificano automaticamente il tipo di file:

   ```
   find crx-quickstart/repository/datastore -type f -size +100M -exec sh -c "du -hs \"{}\"; file \"{}\"" \;
   ```
- Se trovi che la crescita si verifica nel <b>segmentstore</b> quindi il comando seguente potrebbe aiutare a indicare quali dati vengono scritti:

   ```
   strings data_xxxxxx.tar | egrep '.?/' | sed 's/.$//;s/.\//\//'
   ```

<b>Causa</b>
Alcune possibili cause di aumenti insoliti dell&#39;utilizzo del disco sono:

- La manutenzione corretta non è stata eseguita sul sistema.  Vedi questo articolo per i dettagli sulle varie attività di manutenzione del sistema.
- AEM o l&#39;applicazione sta creando un numero molto elevato di nodi o aggiornamenti alle proprietà dei nodi.  Questo potrebbe essere dovuto a un errore di configurazione o a un bug del codice dell&#39;applicazione.  Poiché lo stoccaggio del tar in Oak funziona in modalità &quot;append-only&quot;, il salvataggio ripetuto dei nodi contribuisce ulteriormente all&#39;eccessiva crescita dell&#39;archivio.
- File molto grandi sono stati caricati su AEM Assets o su package manager.
- La registrazione di debug o traccia è stata lasciata abilitata.

