---
title: "Come bloccare gli indirizzi IP a livello di server HTTP Apache?"
description: Descrizione
solution: Experience Manager
product: Experience Manager
applies-to: "Experience Manager"
keywords: "KCS, blocca indirizzi IP, server HTTP Apache, dispatcher AEM"
resolution: Resolution
internal-notes: null
bug: false
article-created-by: Nayanika Chakravarty
article-created-date: "5/24/2023 3:30:14 PM"
article-published-by: Nayanika Chakravarty
article-published-date: "5/24/2023 3:38:10 PM"
version-number: 6
article-number: KA-17455
dynamics-url: "https://adobe-ent.crm.dynamics.com/main.aspx?forceUCI=1&pagetype=entityrecord&etn=knowledgearticle&id=2365b1db-47fa-ed11-8849-6045bd006b3d"
source-git-commit: 1e84ba49e6ca4ddca5e5058ce62804df6d2835d5
workflow-type: tm+mt
source-wordcount: '247'
ht-degree: 1%

---

# Come bloccare gli indirizzi IP a livello di server HTTP Apache?

## Descrizione {#description}

<b>Ambiente</b>
Adobe Experience Manager


<b>Problemi/Sintomi</b>
Il nostro sito sta sperimentando un attacco di denial of service, spam o hacking. Come bloccare gli indirizzi IP a livello di server HTTP Apache (AEM Dispatcher)?


## Risoluzione {#resolution}


La maggior parte dei firewall per applicazioni web (WAF), ad esempio mod security, può contenere elenchi Bloccati di indirizzi IP. Tuttavia, se desideri bloccare gli IP mentre è in esecuzione il server HTTP Apache, adotta immediatamente la seguente procedura (*non applicabile in caso di AEM as a Cloud Service<b>*)</b>:

1. Crea un file denominato `block-offending-ips.conf` sul server
2. Apri il file in un editor e aggiungi un’istruzione sulla posizione che impedisca a tutti gli IP offensivi di accedere agli URL che desideri bloccare. Sono disponibili due opzioni per il contenuto del file:<br>    A. Se la richiesta è attivata come proxy (tramite CDN, Load Balancer, ecc.) e l’IP dell’utente remoto si trova solo in un’intestazione come X-Forwarded-For, è possibile utilizzare questa configurazione. Tieni presente che questa configurazione non si applica se è configurato remoteip_module.


   ```
   LocationMatch "/.*"
       Order Allow,Deny
       Allow from all
       SetEnvif X-Forwarded-For "10\.42\.137\.123" DenyAccess
       SetEnvif X-Forwarded-For "122\.6\.218\.101" DenyAccess
       #Repeat the "SetEnvlf X-Forwarded-For ..." for each IP you want to block
       Deny from env=DenyAccess
       /LocationMatch
   ```

   B. In alternativa, se l’utente remoto accede direttamente ad Apache o se si utilizza remoteip_module (vedere <b>`[` 1`]` </b> di seguito) per estrarlo e impostarlo all’interno di Apache, puoi utilizzare la proprietà mod_authz_core <b>Richiedi</b> funzionalità diretta (Apache 2.4).


   ```
   LocationMatch "/.*"
       RequireAll
       Require all granted
       Require not ip 10.42.137.123
       Require not ip 122.6.218.101
       #Repeat the "Require not ip ..." for each IP you want to block
       /RequireAll
       /LocationMatch
   ```


   <b>`[` 1`]`  remoteip_module</b>


   ```
   # Extract true client IP from header added by load balancer/CDN
       IfModule remotetip module
       # valid for ELB or ELB+CloudFront
       RemoteIPHeader X-Forwarded-For
       IfModule
   ```


3. Rilascia il file block-offending-ips.conf nella cartella /etc/conf.d del server web Apache.
4. Riavvia il server HTTP Apache.

